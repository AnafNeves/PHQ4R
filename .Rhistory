theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = c("Depression_3", "Depression_4"),
x = c(-1.5, -1.5)),
aes(xintercept = x))
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = c("Depression_3", "Depression_4"),
x = c(-1.5, -1.5)),
aes(xintercept = x)) +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = c("Depression_3", "Depression_4"),
x = c(-1.5, -1.5)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rep(c("Depression_3", "Depression_4"), 2)
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.5, 2.5)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
item4 <- rez[rez$Item == "Depression_4", ]
item4 <- rez |>
filter(Item == "Depression_4") |>
filter(Theta >= -1.5 & Theta <= 2.25)
item4
item4 <- rez |>
filter(Item == "Depression_4") |>
filter(Theta >= -1.5 & Theta <= 2.25)
item4 <- rez |>
filter(Item == "Depression_4") |>
filter(Theta >= -1.5 & Theta <= 2.25) |>
mutate(Theta = normalize(Theta))
item4 |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line() +
theme_modern()
item4 |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line() +
theme_modern()
item4[item4$Answer == "Once or twice", ]
item4[item4$Answer == "Once or twice" & which.max(Probability), ]
item4[item4$Answer == "Once or twice" & which.max(item4$Probability), ]
which.max(item4$Probability)
item4$Probability
item4[item4$Answer == "Once or twice" && which.max(item4$Probability), ]
item4[item4$Answer == "Once or twice", "Probability"]
which.max(item4[item4$Answer == "Once or twice", "Probability"])
item4[item4$Answer == "Once or twice", ]
item4 |>
group_by(Answer) |>
filter(Probability = max(Probability))
item4 |>
group_by(Answer) |>
filter(Probability == max(Probability))
item4 |>
group_by(Answer) |>
filter(Probability == max(Probability)) |>
ungroup()
scores <- item4 |>
group_by(Answer) |>
filter(Probability == max(Probability)) |>
ungroup()
plot(mod1, type='infotrace', theta_lim = c(-3, 3))
mirt::iteminfo(mod1)
as.data.frame(iteminfo(extract.item(mod1, i), Theta))
dat <- iteminfo(extract.item(mod1, i), Theta)
dat
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- iteminfo(extract.item(mod1, i), Theta)
dat <- pivot_longer(dat, -Theta, names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- iteminfo(extract.item(mod1, i), Theta)
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
rez
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line(aes(y = Information)) +
geom_line() +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
rez |>
ggplot(aes(x = Theta, y = Probability, color = Answer)) +
geom_line(aes(y = Information)) +
geom_line() +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information)) +
geom_line(aes(color = Answer)) +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted") +
geom_line(aes(color = Answer)) +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
# Factor
summary(mod1)
crc <- function(mod, data) {
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(data = data.frame(
Item = rep(c("Depression_3", "Depression_4"), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
list(p = p, rez = rez)
}
out <- crc(mod1, data)
out$p
data <- select(df, contains("Anxiety"))
m_anxiety <- mirt(data, model = 1, itemtype = 'graded', SE = TRUE)
M2(m_anxiety, type = "C2", calcNULL = FALSE)
itemfit(m_anxiety)
# IRT parameters
IRT_parms <- coef(m_anxiety, IRTpars = TRUE, simplify = TRUE)
IRT_parms$items
# Factor
summary(m_anxiety)
# Plots
plot(m_anxiety, type = 'score', theta_lim = c(-3, 3))
plot(m_anxiety, type = 'infoSE', theta_lim = c(-3, 3))
plot(m_anxiety, type = 'rxx', theta_lim = c(-3, 3))
out <- crc(m_anxiety, data)
out$p
crc <- function(mod, data) {
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(data = data.frame(
Item = rep(names(data), 2),
x = c(-1.5, -1.5, 2.25, 2.25)),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
list(p = p, rez = rez)
}
crc <- function(mod, data, x = c(-1.5, -1.5, 2.25, 2.25)) {
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(data = data.frame(
Item = rep(names(data), 2),
x = x),
aes(xintercept = x), linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
list(p = p, rez = rez)
}
out <- crc(m_anxiety, data, x = c(-1.5, -1.5, 2.25, 2.25))
out$p
data
model <- mirt.model()
Depression = 3,4'
df
df <- read.csv("https://raw.githubusercontent.com/RealityBending/IllusionGameReliability/main/data/preprocessed_questionnaires.csv") |>
select(starts_with("Item_PHQ4")) |>
datawizard::remove_empty_rows()
names(df) <- str_remove_all(names(df), "Item_PHQ4_")
mod1 <- mirt(df, model = mirt.model(s), itemtype = 'graded', SE = TRUE)
s <- 'Anxiety = 1,2
Depression = 3,4'
mod1 <- mirt(df, model = mirt.model(s), itemtype = 'graded', SE = TRUE)
M2(mod1, type = "C2", calcNULL = FALSE)
# IRT parameters
IRT_parms <- coef(mod1, IRTpars = TRUE, simplify = TRUE)
IRT_parms$items
# Plots
plot(mod1, type = 'score', theta_lim = c(-3, 3))
plot(mod1, type = 'infoSE', theta_lim = c(-3, 3))
plot(mod1, type = 'rxx', theta_lim = c(-3, 3))
# Plots
plot(mod1, type = 'infotrace', theta_lim = c(-3, 3))
# Plots
plot(mod1, type = 'trace', theta_lim = c(-3, 3))
COV = Anxiety*Depression'
mod1 <- mirt(df, model = mirt.model(s), itemtype = 'graded', SE = TRUE)
data <- select(df, contains("Depression"))
s <- 'Anxiety = 1,2
Depression = 3,4
COV = Anxiety*Depression'
mod1 <- mirt(df, model = mirt.model(s), itemtype = 'graded', SE = TRUE)
# Plots
plot(mod1, type = 'trace', theta_lim = c(-3, 3))
plot(mod1, type = 'infotrace', theta_lim = c(-3, 3))
plot(mod1, type = 'score', theta_lim = c(-3, 3))
crc <- function(mod, data, x = c(-1., 2.25)) {
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(xintercept = x, linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
list(p = p, rez = rez)
}
out <- crc(mod1, data)
data <- select(df, contains("Depression"))
mod1 <- mirt(data, model = 1, itemtype = 'graded', SE = TRUE)
out <- crc(mod1, data)
out$p
crc <- function(mod, data, x = c(-1.25, 2.25)) {
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(xintercept = x, linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
list(p = p, rez = rez)
}
out <- crc(mod1, data)
out$p
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(xintercept = x, linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
x = c(-1.25, 2.25)
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(xintercept = x, linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(xintercept = x, linetype = "dashed") +
facet_grid(~Item) +
labs(x = expression(theta)) +
theme_modern()
p
crc <- function(mod, data, x = c(-1.25, 2.25)) {
Theta <- matrix(seq(-3, 3, by = .01))
rez <- data.frame()
for(i in 1:2) {
dat <- as.data.frame(probtrace(extract.item(mod1, i), Theta))
dat$Theta <- Theta[,1]
dat$Information <- normalize(iteminfo(extract.item(mod1, i), Theta))
dat <- pivot_longer(dat, -one_of(c("Theta", "Information")), names_to = "Answer", values_to = "Probability")
dat$Item <- names(data)[i]
rez <- rbind(rez, dat)
}
rez <- rez |>
mutate(
Answer = case_when(
Answer == "P.1" ~ "Not at all",
Answer == "P.2" ~ "Once or twice",
Answer == "P.3" ~ "Several days",
Answer == "P.4" ~ "More than half the days",
TRUE ~ "Nearly every day"
)) |>
mutate(
Answer = fct_relevel(Answer, c("Not at all", "Once or twice", "Several days", "More than half the days",  "Nearly every day")))
p <- rez |>
ggplot(aes(x = Theta, y = Probability)) +
geom_line(aes(y = Information), linetype = "dotted", color = "grey") +
geom_line(aes(color = Answer)) +
geom_vline(xintercept = x, linetype = "dashed") +
facet_grid(~Item) +
theme_modern()
list(p = p, rez = rez)
}
out <- crc(mod1, data)
out$p +
labs(x = expression("Depression (", theta))
out$p +
labs(x = paste0("Depression (", expression(theta)))
out$p +
labs(x = expression(Depression~(theta)~))
out$p +
labs(x = expression(Depression~(theta\)))
labs(x = expression(Depression~(theta))
)
out$p +
labs(x = expression(Depression~(theta)))
out <- crc(mod1, data, x = c(-1.25, 2.25))
out$p +
labs(x = expression(Depression~(theta)))
